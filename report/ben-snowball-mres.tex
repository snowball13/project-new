\documentclass[11pt, oneside]{article}   	% use "amsart" instead of "article" for AMSLaTeX format
\usepackage{geometry}                		% See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   		% ... or a4paper or a5paper or ... 
%\geometry{landscape}                		% Activate for rotated page geometry
\usepackage[parfill]{parskip}    		% Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}				% Use pdf, png, jpg, or epsÂ§ with pdflatex; use eps in DVI mode
								% TeX will automatically convert eps --> pdf in pdflatex		
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{bbm}

%SetFonts

%SetFonts

\newcommand{\R}{\mathbb{R}}
\newcommand{\MN}{\mathbb{M}_N}
\newcommand{\LN}{\mathbb{L}_N}
\newcommand{\dsm}{d_\mathbb{S}(m)}
\newcommand{\dsmsq}{d^{2}_{\mathbb{S}}(m)}
\newcommand{\graddsmsq}{\nabla{d^{2}_{\mathbb{S}}(m)}}
\newcommand{\eone}{\hat{e}_1}
\newcommand{\etwo}{\hat{e}_2}
\newcommand{\bt}{\tilde{b}}
\newcommand{\pt}{\tilde{p}}
\newcommand{\dt}{\Delta t}
\newcommand{\M}{\mathbb{M}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Ps}{\mathbb{P}_{\mathbb{S}}}
\newcommand{\Pm}{\mathbb{P}_{\mathbb{M}_N}}
\newcommand{\Leb}{\mathrm{Leb}}
\newcommand{\DmDt}{\frac{\mathrm{D}m}{\mathrm{D}t}}
\newcommand{\DuDt}{\frac{\mathrm{D}u}{\mathrm{D}t}}


\title{MRes Report}
\author{Ben Snowball}
%\date{}							% Activate to display a given date or no date


\begin{document}



\maketitle
\section{Introduction}

The main goal of this paper is to investigate whether using a new optimal transport timestepping method can be used to simulate an Eady model describing weather fronts. The ultimate aim is to apply the method to the model, and see how it compares to the Eulerian solution. The theory is that a Lagrangian framed approach might better resolve the frontal problem in weather forecasting.

In Section 2 of this report, we provide some background on optimal transport approach and a simplectic timestepping method that will be part of our new method. In Section 3 we propose the method, and detail how our program works when applied to two examples: a simple Beltrami flow in a unit square, and a situation of a number of vortices placed in a unit square. We then in Section 4 present some results and finally give an outlook on where this work can head next in Section 5.


\section{Background}

\subsection{Optimal Transport Approach}

We begin by outlining notation. Our domain for our problem is \(\Omega = [-L, L] \times [-H, H] \subset \R^2\) with periodic boundary conditions in the \(x\)-direction. Let \(\M := L^2(\Omega, \R^2)\). We define \(\mathbb{S}\) as the set of volume preserving maps from \(\Omega \to \R^2\), that is:
\begin{align}
\mathbb{S} &= \{ s \in \M \quad | \quad s_{\#}\Leb(A) := \Leb(s^{-1}(A)) = \Leb(A) \quad \forall A \subset \Omega \},
\end{align}

so \(\mathbb{S} \subset \M\). Now, for \(N \in \N\), we define a tessellation partition \(P_N\) of \(\Omega\) into \(N\) subsets \(\omega_i, i=1,\dots,N\) such that:

\begin{align}
1)& \quad \Leb(\omega_i) = \frac{1}{N}\Leb(\Omega) \quad \forall i = 1,\dots,N \\
2)& \quad \max_{i = 1,\dots,N} \mathrm{diam}(\omega_i) \le CN^{-\frac{1}{2}}, \quad C \text{ independent of } N.
\end{align}

Then we define \(\MN\) to be the space of functions from \(\Omega\) to \(\R^2\) which are constant on each of the subdomains \(\omega_i\) of \(P_N\), i.e.
\begin{align}
\MN &= \{ \phi \: : \: \Omega \to \R^2 \quad | \quad \phi | _{\omega_i} \text{ is constant, } i = 1,\dots,N\}.
\end{align}

We note the meaning of the (squared) distance from a map in \(\MN\) to the set \(\mathbb{S}\) is given by \(\dsmsq \: : \: \MN \to \R\) where
\begin{align}
\dsmsq &:= \min_{s \in \mathbb{S}} || m - s || ^2_{L^2}, \quad m \in \MN.
\end{align}

Since \(\mathbb{S}\) is closed but not convex, the orthogonal projection of a map in \(\mathbb{S}\) exists, but is not uniquely defined, and so is simply given as any map that is a projection. In other words, a projection of \(m \in \mathbb{M}\), \(P_\mathbb{S}(m)\), is any point satisfying
\begin{align}
|| P_\mathbb{S}(m) - m || &= \dsmsq,
\end{align}

and denote the orthogonal projection mapping on \(\MN\) by \(P_{\MN}\).

We choose a set of variables \(z = (m, u, v, b) \in \MN \times \MN \), that satisfy the system of equations:
\begin{align} 
\dot{m} &= u, \\
\dot{u} &= - \nabla p
\end{align}

where \(\nabla p = \graddsmsq\).

From (reference for Quentin 1), a calculatable formula for \(\graddsmsq\) exists. First, we introduce the definition of a Laguerre diagram. Let \(M = (M_1,\dots,M_N), \text{ where } M_i \in \R^2, \psi = (\psi_1,\dots,\psi_N), \text{ where } \psi_i \in \R\). The Laguerre diagram is a decomposition of \(\R^2\) into \(N\) convex polyhedra (Laguerre cells) defined by:
\begin{align}
\mathrm{Lag}_i(M, \psi) &= \{x \in \R^2 \quad | \quad || x - M_i ||^2 + \psi_i \le || x - M_j ||^2 + \psi_j, \quad \forall j = 1,\dots,N\}
\end{align}

Proposition 1: Let \(m \in \MN\) and define \(M_i := m(\omega_i) \in \R^2 \text{ for } i = 1,\dots,N\) with \(M = (M_1,\dots,M_N)\). Then there exists \(\psi = (\psi_1,\dots,\psi_N), \psi \in \R\), unique up to additive constant such that, with \(L_i := \mathrm{Lag}_i(M, \psi)\), 
\begin{align}
\Leb(L_i) &= \frac{1}{N}\Leb(\Omega),
\end{align}
and
\begin{align}
\graddsmsq &= 2(m - P_{\MN} \circ P_{\mathbb{S}}(m)),
\end{align}
where
\begin{align}
P_{\MN} \circ P_{\mathbb{S}}(m) &= \sum^N_{i=1} B_i \mathbbm{1}_{L_i}(m), \\
B_i &:= \frac{1}{\Leb(L_i)} \int_{L_i} x \: \mathrm{d}x, \quad i = 1,\dots,N. 
\end{align}

Something about optimal transport in words....????



\subsection{RATTLE Algorithm}

(Paper) describes the RATTLE algorithm that we modify to be part of our timestepping method. Originally devised to be applied to molecular dynamics simulations, the RATTLE algorithm is used to solve constrained dynamical equations. 

Hamiltonian systems of differential equations like (8-9) have a flow that demonstrates a symplectic geometry[, meaning that the sum of the areas of the projections of an orientated 2D surface in the phase space onto the \((m_i, u_i)\) coordinate planes are unchanged under the flow.] Importantly, it has been established that symplectic methods have better long-term stability properties than non-symplectic methods. [RATTLE ref, 20]. RATTLE is an example of a Verlet method for constrained problems, which is symplectic.


\section{Method}

Here, we describe the process of obtaining our model. Let \(m\) be the 2-dimensional position vector in the \(x,z\text{-plane}\), and let \(u\) be the 2-dimensional velocity vector. The simple model describing the incompressible flow is:
\begin{align}
\DmDt &= u, \\
\DuDt &= -\nabla p, 
\end{align}
where \(\frac{\mathrm{D}}{\mathrm{D}t}\) is the material derivative, and \(p\) is some pressure term. We add the constraint that we wish the distance from our point in space mapping \(m\) to the set of measure preserving maps \(\mathbb{S}\) to be zero. This means that in order to have a conserved Hamiltonian we need to incorporate this into it....

....

We can formulate the simple flow problem as a constrained problem as follows. The undiscretised incompressible Euler equations can be written in Lagrangian form as:
\begin{align}
& \dot{m}(a, t) = u(a,t), \quad \text{contraint}: \: \dsmsq = 0 \\
\iff
 &\begin{cases}
  \dot{m} = u \\
  \dot{u} = \lambda \graddsmsq, \quad \lambda = \lambda(t) \text{ a Lagrange multiplier enforcing } \dsmsq = 0.
 \end{cases} 
\end{align}

Restricting \(m\) to be in \(\MN\) would mean we cannot enforce the constraint. To address this, we choose an initial condition \(m(0) =: m^{(0)}\) and set
\begin{align}
c &:= d^{2}_{\mathbb{S}}(m^{(0)})
\end{align}

so \(c\) is independent of \(t\) and gives the "distance" from an incompressible state that the particles initially lie. We then solve
\begin{align}
 &\begin{cases}
  \dot{m} = u \\
  \dot{u} = \lambda \graddsmsq, \quad \lambda = \lambda(t) \text{ a Lagrange multiplier enforcing } \dsmsq \le c.
 \end{cases} 
\end{align}

Define, for each timestep \(n\), \(b^n := \nabla{d^{2}_{\mathbb{S}}(m^n)}\). Our modified RATTLE algorithm, applied to this problem, is then:

Algorithm 1:
\begin{align*}
 &\text{IF } (m^n + \dt \; u^n < c) \\
 &\quad \text{set } m^{n+1} = m^n + \dt \; u^n, \: \: u^{n+1} = u^n \\
 &\text{ELSE } \\
 &\quad 
 \begin{cases}
  m^{n+1} = m^{n} + \dt \; u^{n+1/2}  \\
  u^{n+1/2} = u^n - \frac{\dt}{2} \lambda^n b^n \\
  b^{n+1} - c = 0
 \end{cases} \\
 &\quad 
 \text{and, } \nonumber \\
 &\quad 
 \begin{cases}
  u^{n+1} = u^{n+1/2} - \frac{\dt}{2} \hat{\lambda}^{n+1} b^{n+1} \\
  u^{n+1} \cdot b^{n+1} = 0.
 \end{cases} 
\end{align*}

For clarity, we note that the constraint in the first bracketed section of the algorithm is used to find the Lagrange multiplier \(\lambda^n\) such that the constraint is satisfied, which is then used to calculate \(u^{n+1/2}\) and hence \(m^{n+1}\). We do this using an iterative method, such as Newton. For the seconded bracketed section, the Lagrange multiplier \(\hat{\lambda}^{n+1}\) can be calculated directly from the constraint with no need for an iterative method.


\section{Results}




\section{Summary and Outlook}

In this report we have looked at setting out a potential new timestepping method that involves optimal transport and a constrained symplectic algorithm. We have given some background to the method, as well as establishing its convergence numerically suing a couple of examples. 

When looking at implementing on the Eady model problem itself, we encountered issues relating to the implementation of the periodic boundary conditions, as well as the aspect ratio of the large domain (about 100x larger in the horizontal than the vertical. One solution to this latter problem could be to redefine the distance metric used in the Laguerre cells definition given, to "penalise" distance moved in the vertical direction by the appropriate amount (the ratio). Ultimately, we would look to gain a mathematical proof for convergence and stability of the method, and look to implement it for the full Eady model problem and see how it compares to the Eulerian solution.


\end{document}











  